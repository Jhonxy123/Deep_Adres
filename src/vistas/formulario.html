<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Reclamación</title>
  <link rel="stylesheet" href="css/formulario.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="layout"></div>
  <main>

   
    <form class="formulario" method="POST" action="/formulario">
       <h2>I. Datos del beneficiario de la reclamación</h2>
      <div class="fila">
        <input type="text" name="beneficiario.primer_apellido" placeholder="Primer Apellido">
        <input type="text" name="beneficiario.segundo_apellido" placeholder="Segundo Apellido">
      </div>

      <div class="fila">
        <input type="text" name="beneficiario.primer_nombre" placeholder="Primer Nombre">
        <input type="text" name="beneficiario.segundo_nombre" placeholder="Segundo Nombre">
      </div>

      <div class="fila">
        <select name="beneficiario.tipo_documento">
          <option value="">Tipo de documento</option>
          <option value="Cedula">Cédula</option>
          <option value="Cedula de Extranjeria">Cédula de Extranjeria</option>
          <option value="Pasaporte">Pasaporte</option>
          <option value="Permiso Especial de Permanencia">Permiso Especial de Permanencia</option>
          <option value="Permiso por Protección Temporal">Permiso por Protección Temporal</option>
        </select>
      
        <input type="text" name="beneficiario.numero_documento" placeholder="No. de documento">
      </div>
      
      <div class="fila">
        <label>Dirección de domicilio:</label>
        <input type="text" name="beneficiario.direccion">
      </div>
      
      <div class="fila">
        <label>Correo electrónico:</label>
        <input type="email" name="beneficiario.correo">
      </div>

      <div class="fila">
        <label>Departamento:</label>
        <select id="beneficiario.departamento" name="beneficiario.departamento">
          <option value="">Derpartamento</option>
          <option value="1">Amazonas</option>
          <option value="2">Antioquia</option>
          <option value="3">Arauca</option>
          <option value="4">Atlántico</option>
          <option value="5">Bolívar</option>
          <option value="6">Boyacá</option>
          <option value="7">Caldas</option>
          <option value="8">Caquetá</option>
          <option value="9">Casanare</option>
          <option value="10">Cauca</option>
          <option value="11">Cesar</option>
          <option value="12">Chocó</option>
          <option value="13">Córdoba</option>
          <option value="14">Cundinamarca</option>
          <option value="15">Guainía</option>
          <option value="16">Guaviare</option>
          <option value="17">Huila</option>
          <option value="18">La Guajira</option>
          <option value="19">Magdalena</option>
          <option value="20">Meta</option>
          <option value="21">Nariño</option>
          <option value="22">Norte de Santander</option>
          <option value="23">Putumayo</option>
          <option value="24">Quindío</option>
          <option value="25">Risaralda</option>
          <option value="26">San Andrés y Providencia</option>
          <option value="27">Santander</option>
          <option value="28">Sucre</option>
          <option value="29">Tolima</option>
          <option value="30">Valle del Cauca</option>
          <option value="31">Vaupés</option>
          <option value="32">Vichada</option>
          <option value="33">Bogotá D.C.</option>
        </select>

        <label>Teléfono:</label>
        <input type="text" name="beneficiario.telefono">
      </div>

      <div class="fila">
        <label>Municipio:</label>
        <input type="text" name="beneficiario.municipio">

        <label>Celular:</label>
        <input type="text" name="beneficiario.celular">
      </div>

      <div class="fila">
        <label>Cuenta bancaria:</label>
        <input type="text" name="beneficiario.cuenta_bancaria">
      </div>

      <div class="fila">
        <label>Banco:</label>
        <input type="text" name="beneficiario.banco">

        <label>Tipo de cuenta:</label>
        <input type="text" name="beneficiario.tipo_cuenta">
      </div>

      <div class="fila">
        <label>parentesco con la victima:</label>
        <select name="parentesco.tipo_victima">
            <option value="">Parentesco con la victima</option>
            <option value="Padres">Padres</option>
            <option value="Hermanos">Hermanos</option>
            <option value="Hijos">Hijos</option>
            <option value="Conyugue">Cónyugue</option>
            <option value="Compañero (a) permanente">Compañero (a) permanente</option>
            <option value="Representante Legal">Representante Legal</option>
        </select>
    </div>

    <hr>
    <h2>II. Datos del apoderado (abogado con poder para tramitar la reclamación)</h2>

    <div class="fila">
        <input type="text" name="apoderado.primer_apellido" placeholder="Primer Apellido">
        <input type="text" name="apoderado.segundo_apellido" placeholder="Segundo Apellido">
    </div>

    <div class="fila">
        <input type="text" name="apoderado.primer_nombre" placeholder="Primer Nombre">
        <input type="text" name="apoderado.segundo_nombre" placeholder="Segundo Nombre">
    </div>

    <div class="fila">
        <select name="apoderado.tipo_documento">
            <option value="">Tipo de documento</option>
            <option value="Cedula">Cédula</option>
            <option value="Cedula de extrajeria">Cédula de Extranjería</option>
        </select>
        <input type="text" name="apoderado.numero_documento" placeholder="No. de documento">
    </div>

    <div class="fila">
        <label>Dirección:</label>
        <input type="text" name="apoderado.direccion">
    </div>

    <div class="fila">
        <label>Correo electrónico:</label>
        <input type="email" name="apoderado.correo">
    </div>

    <div class="fila">
        <label>Departamento:</label>
        <input type="text" name="apoderado.departamento">
        <label>Teléfono:</label>
        <input type="text" name="apoderado.telefono">
    </div>

    <div class="fila">
        <label>Municipio:</label>
        <input type="text" name="apoderado.municipio">
        <label>Tarjeta Profesional:</label>
        <input type="text" name="apoderado.tarjeta_profesional">
    </div>

    <hr>
    <h2>III. Datos de la víctima del evento catastrófico o accidente de tránsito</h2>

    <div class="fila">
        <input type="text" name="victima.primer_apellido" placeholder="Primer Apellido">
        <input type="text" name="victima.segundo_apellido" placeholder="Segundo Apellido">
    </div>

    <div class="fila">
        <input type="text" name="victima.primer_nombre" placeholder="Primer Nombre">
        <input type="text" name="victima.segundo_nombre" placeholder="Segundo Nombre">
    </div>

    <div class="fila">
        <select name="victima.tipo_documento">
            <option value="">Tipo de documento</option>
            <option value="Cédula de Ciudadanía">Cédula de Ciudadanía (CC)</option>
            <option value="Cédula de Extranjería">Cédula de Extranjería (CE)</option>
            <option value="Tarjeta de Identidad">Tarjeta de Identidad (TI)</option>
            <option value="Pasaporte">Pasaporte (PA)</option>
            <option value="Registro Civil">Registro Civil (RC)</option>
            <option value="Permiso Especial de Permanencia">Permiso Especial de Permanencia (PE)</option>
            <option value="Permiso por Protección Temporal">Permiso por Protección Temporal (PT)</option>
            <option value="Salvoconducto">Salvoconducto (SC)</option>
            <option value="Carné Diplomático">Carné Diplomático (CD)</option>
            <option value="Documento Extranjero">Documento Extranjero (DE)</option>
            <option value="Certificado de Nacimiento">Certificado de Nacimiento (CN)</option>
        </select>
        <input type="text" name="victima.numero_documento" placeholder="No. de documento">
    </div>

    <div class="fila">
        <label>Fecha de nacimiento:</label>
        <input type="date" name="victima.fecha_nacimiento">
        <label>Sexo:</label>
        <select name="victima.sexo">
            <option value="">Seleccione</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
        </select>
    </div>

    <div class="fila">
        <label>Dirección de domicilio:</label>
        <input type="text" name="victima.direccion">
    </div>

    <div class="fila">
        <label>Departamento:</label>
        <input type="text" name="victima.departamento">
        <label>Municipio:</label>
        <input type="text" name="victima.municipio">
    </div>

    <div class="fila">
        <label>Zona:</label>
        <select name="victima.zona">
            <option value="">Seleccione</option>
            <option value="Urbana">Urbana</option>
            <option value="Rural">Rural</option>
        </select>
        <label>Condición del accidentado:</label>
        <select name="victima.condicion">
            <option value="">Seleccione</option>
            <option value="Conductor">Conductor</option>
            <option value="Peatón">Peatón</option>
            <option value="Ocupante">Ocupante</option>
        </select>
    </div>

    <div class="fila">
        <label>Teléfono:</label>
        <input type="text" name="victima.telefono">
        <label>Fecha en caso de muerte:</label>
        <input type="date" name="victima.fecha_muerte">
    </div>

    <hr>
    <h2>IV. Datos del sitio donde ocurrió el evento catastrófico o accidente de tránsito</h2>

    <p><strong>Naturaleza del evento</strong></p>

    <div class="fila">
        <label>Accidente de tránsito:</label>
        <input type="checkbox" name="evento.accidente_transito" value="true">

        <label>Naturales:</label>
        <select name="evento.natural">
            <option value="Ninguno">Ninguno</option>
            <option value="Sismo">Sismo</option>
            <option value="Avalancha">Avalancha</option>
            <option value="Maremoto">Maremoto</option>
            <option value="Deslizamiento de tierra">Deslizamiento de tierra</option>
            <option value="Erupciones volcanica">Erupciones volcánica</option>
            <option value="Incendio natural">Incendio natural</option>
            <option value="Huracan">Huracan</option>
            <option value="Rayo">Rayo</option>
            <option value="Inundacion">Inundación</option>
            <option value="Vendabal">Ninguno</option
            <option value="Tornado">Tornado</option>
        </select>

        <label>Terroristas:</label>
        <select name="evento.terrorista">
            <option value="Ninguno">Ninguno</option>
            <option value="Masacre">Masacre</option>
            <option value="Mina Antipersona">Mina antipersona</option>
            <option value="Incendio">Incendio</option>
            <option value="Ataque a municipio">Ataque a municipio</option>
            <option value="Combate">Combate</option>
        </select>
    </div>

    <div class="fila">
        <label>Otros:</label>
        <input type="checkbox" name="evento.otro" value="true">
        <label>Cuál:</label>
        <input type="text" name="evento.otro_descripcion" placeholder="Especificar otro tipo de evento">
    </div>

    <div class="fila">
        <label>Dirección de la ocurrencia:</label>
        <input type="text" name="evento.direccion">
    </div>

    <div class="fila">
        <label>Fecha evento/accidente:</label>
        <input type="date" name="evento.fecha">
        <label>Hora:</label>
        <input type="time" name="evento.hora" step="1">
    </div>

    <div class="fila">
        <label>Departamento:</label>
        <input type="text" name="evento.departamento">
        <label>Municipio:</label>
        <input type="text" name="evento.municipio">
    </div>

    <div class="fila">
        <p><strong>Descripción breve del evento catastrófico o accidente de tránsito</strong></p>
        <p>Enuncie las principales características del evento / accidente:</p>
        <textarea rows="5" style="width: 100%; border-radius: 10px;" name="evento.descripcion"></textarea>
    </div>

    <hr>
    <h2>V. Información del vehículo del accidente de tránsito</h2>

    <div class="fila">
      <label>Estado de aseguramiento:</label>
      <select name="vehiculo.aseguramiento">
        <option value="">Seleccione...</option>
        <option value="asegurado">Asegurado</option>
        <option value="no_asegurado">No asegurado</option>
        <option value="Vehiculo fantasma">Vehículo fantasma</option>
        <option value="Poliza falsa">Póliza falsa</option>
        <option value="No asegurado y sin placa">No asegurado y sin placa</option>
        <option value="No asegurado - propietario Indeterminado o sin información">No asegurado - propietario Indeterminado o sin información</option>
      </select>
    </div>

    <div class="fila">
      <label>Marca:</label>
      <input type="text" name="vehiculo.marca">
      
      <label>Placa:</label>
      <input type="text" name="vehiculo.placa">
    </div>

    <div class="fila">
      <label>Tipo de servicio:</label>
      <select name="vehiculo.tipo_servicio">
        <option value="">Seleccione...</option>
        <option value="Automovil">Automovil</option>
        <option value="Motocicleta">Motocicleta</option>
        <option value="Bus">Bus</option>
        <option value="Buseta">Buseta</option>
        <option value="Camion">Camión</option>
        <option value="Camioneta">Camioneta</option>
        <option value="Campero">Campero</option>
        <option value="Microbus">Microbus</option>
        <option value="Tractocamion">Tractocamión</option>
        <option value="Motocarro">Motocarro</option>
        <option value="Mototriciclo">Mototriciclo</option>
        <option value="Cuatrimoto">Cuatrimoto</option>
        <option value="Moto extranjera">Moto extranjera</option>
        <option value="Vehiculo extranjero">Vehículo extranjero</option>
      </select>

      <label>Intervención de la autoridad:</label>
      <select name="vehiculo.intervencion_autoridad">
        <option value="">Seleccione...</option>
        <option value="si">Sí</option>
        <option value="no">No</option>
      </select>
    </div>

    <div class="fila">
      <label>Nombre de la aseguradora:</label>
      <input type="text" name="vehiculo.aseguradora">
    </div>

    <div class="fila">
      <label>Número de la póliza:</label>
      <input type="text" name="vehiculo.numero_poliza">
    </div>

    <div class="fila">
      <label>Vigencia desde:</label>
      <input type="date" name="vehiculo.vigencia_desde">

      <label>hasta:</label>
      <input type="date" name="vehiculo.vigencia_hasta">
    </div>

    <hr>
    <h2>VI. Datos del propietario del vehículo</h2>

    <div class="fila">
      <input type="text" name="propietario.primer_apellido" placeholder="Primer Apellido">
      <input type="text" name="propietario.segundo_apellido" placeholder="Segundo Apellido">
    </div>

    <div class="fila">
      <input type="text" name="propietario.primer_nombre" placeholder="Primer Nombre">
      <input type="text" name="propietario.segundo_nombre" placeholder="Segundo Nombre">
    </div>

    <div class="fila">
      <select name="propietario.tipo_documento">
        <option value="">Tipo de documento</option>
        <option value="CC">Cédula de Ciudadanía (CC)</option>
        <option value="CE">Cédula de Extranjería (CE)</option>
        <option value="PA">Pasaporte (PA)</option>
        <option value="NIT">Número de Identificación Tributaria (NIT)</option>
        <option value="TI">Tarjeta de Identidad (TI)</option>
        <option value="PE">Permiso Especial de Permanencia (PE)</option>
        <option value="PT">Permiso por Protección Temporal (PT)</option>
        <option value="CD">Carné Diplomático (CD)</option>
        <option value="DE">Documento Extranjero (DE)</option>
      </select>
      <input type="text" name="propietario.numero_documento" placeholder="No. de documento">
    </div>

    <div class="fila">
      <label>Dirección de domicilio:</label>
      <input type="text" name="propietario.direccion">
    </div>

    <div class="fila">
      <label>Departamento:</label>
      <input type="text" name="propietario.departamento">

      <label>Teléfono o celular:</label>
      <input type="tel" name="propietario.telefono">
    </div>

    <div class="fila">
      <label>Municipio:</label>
      <input type="text" name="propietario.municipio">
    </div>

    <hr>
    <h2>VII. Datos del conductor del vehículo</h2>

    <div class="fila">
      <input type="text" name="conductor.primer_apellido" placeholder="Primer Apellido">
      <input type="text" name="conductor.segundo_apellido" placeholder="Segundo Apellido">
    </div>

    <div class="fila">
      <input type="text" name="conductor.primer_nombre" placeholder="Primer Nombre">
      <input type="text" name="conductor.segundo_nombre" placeholder="Segundo Nombre">
    </div>

    <div class="fila">
      <select name="conductor.tipo_documento">
        <option value="">Tipo de documento</option>
        <option value="CC">Cédula de Ciudadanía (CC)</option>
        <option value="CE">Cédula de Extranjería (CE)</option>
        <option value="PA">Pasaporte (PA)</option>
        <option value="RC">Registro Civil (RC)</option>
        <option value="TI">Tarjeta de Identidad (TI)</option>
        <option value="PE">Permiso Especial de Permanencia (PE)</option>
        <option value="PT">Permiso por Protección Temporal (PT)</option>
        <option value="SC">Salvoconducto (SC)</option>
        <option value="CD">Carné Diplomático (CD)</option>
        <option value="DE">Documento Extranjero (DE)</option>
        <option value="SI">Sin Identificación (SI)</option>
        <option value="AS">Adulto Sin Identificación (AS)</option>
        <option value="MS">Menor Sin Identificación (MS)</option>
      </select>
      <input type="text" name="conductor.numero_documento" placeholder="No. de documento">
    </div>

    <div class="fila">
      <label>Dirección de domicilio:</label>
      <input type="text" name="conductor.direccion">
    </div>

    <div class="fila">
      <label>Departamento:</label>
      <input type="text" name="conductor.departamento">
      <label>Teléfono o celular:</label>
      <input type="tel" name="conductor.telefono">
    </div>

    <div class="fila">
      <label>Municipio:</label>
      <input type="text" name="conductor.municipio">
    </div>

    <hr>
    <h2>VIII. Amparos que reclama</h2>

    <div class="fila">
      <label>Concepto reclamado:</label>
      <select name="reclamacion.concepto">
        <option value="">Seleccione...</option>
        <option value="Indemnización por muerte y Gastos Funerarios">Indemnización por muerte y Gastos funerarios</option>
        <option value="Incapacidad permanente">Incapacidad permanente</option>
      </select>
    </div>

    <div class="fila">
      <label>Valor:</label>
      <input type="number" name="reclamacion.valor" placeholder="$">
    </div>
    
    <div class="actions" style="margin-top: 20px;">
      <button type="submit" id="btn-enviar" class="btn btn-enviar" style="background-color: #0057ff; color: white;">Enviar</button>
      <button type="button" id="btn-volver" class="btn btn-volver" onclick="window.history.back()" style="background-color: #222; color: white; margin-left: 10px;">Volver</button>
    </div>
  
  </form>
</main>
 <script src="componentes_html/cargarcomponentes.js"></script>

  <script>
    cargarComponente("#layout", "componentes_html/layout_user.html");
  </script>

<script type="module">

  import indemnizacionDAO from '../modelo/DAO_indemnizacion.js';


  document.addEventListener('DOMContentLoaded', async () => {
    const select = document.getElementById('beneficiario.departamento');

    try {
      const departamentos = await indemnizacionDAO.traerDepartamentos();
      select.innerHTML = '<option value="">-- Selecciona --</option>';

      departamentos.forEach(element => {
        const option = document.createElement('option');
        option.value = element.id;
        option.textContent = element.departamento;
        select.appendChild(option);
      });
    } catch (error) {
      console.error('Error al cargar departamentos:', error);
      select.innerHTML = '<option value="">Error al cargar datos</option>';
    }
  });
</script>

<script>
// Variable para controlar el estado del envío
let isSubmitting = false;

document.querySelector('.formulario').addEventListener('submit', function(e) {
  const submitBtn = document.getElementById('btn-enviar');
  
  // Si ya está enviando, prevenir el envío adicional
  if (isSubmitting) {
    e.preventDefault();
    return;
  }
  
  // Marcar como enviando
  isSubmitting = true;
  submitBtn.disabled = true;
  submitBtn.textContent = 'Enviando...';
  submitBtn.style.opacity = '0.7';
  submitBtn.style.cursor = 'not-allowed';
  
  // Opcional: Agregar un spinner
  submitBtn.innerHTML = '<span class="spinner"></span> Enviando...';
  
  // Si hay un error, puedes resetear el estado
  window.addEventListener('unload', function() {
    isSubmitting = false;
    submitBtn.disabled = false;
  });
});
</script>

<style>
.spinner {
  display: inline-block;
  width: 1em;
  height: 1em;
  border: 2px solid rgba(255,255,255,.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>

</body>
</html>